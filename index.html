<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ë–æ–±—Ä—ã: –õ–µ—Å–æ–ø–∏–ª–∫–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* --- 1. –°–¢–ò–õ–ò (–î–ò–ó–ê–ô–ù) --- */
        body {
            background-color: #2c1e18; /* –¢–µ–º–Ω–æ-–∫–æ—Ä–∏—á–Ω–µ–≤—ã–π —Ñ–æ–Ω */
            color: white;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            user-select: none; /* –ß—Ç–æ–±—ã —Ç–µ–∫—Å—Ç –Ω–µ –≤—ã–¥–µ–ª—è–ª—Å—è –ø—Ä–∏ –∫–ª–∏–∫–∞—Ö */
            overflow: hidden;
        }

        .header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #d4a373;
        }

        .balance-container {
            background: #4a3b32;
            padding: 10px 20px;
            border-radius: 15px;
            border: 2px solid #d4a373;
            text-align: center;
        }

        .wood-count {
            font-size: 24px;
            font-weight: bold;
            color: #ffcc00;
        }

        /* –ì–õ–ê–í–ù–ê–Ø –ö–ù–û–ü–ö–ê-–ë–û–ë–ï–† */
        .beaver-btn {
            width: 200px;
            height: 200px;
            background: url('https://cdn-icons-png.flaticon.com/512/3069/3069172.png') no-repeat center center;
            background-size: contain;
            border: none;
            outline: none;
            cursor: pointer;
            transition: transform 0.1s;
            margin: 40px 0;
            -webkit-tap-highlight-color: transparent;
        }

        .beaver-btn:active {
            transform: scale(0.95); /* –≠—Ñ—Ñ–µ–∫—Ç –Ω–∞–∂–∞—Ç–∏—è */
        }

        /* –ú–ê–ì–ê–ó–ò–ù */
        .shop-title {
            margin-top: 20px;
            font-size: 18px;
            color: #aaa;
        }

        .shop-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            width: 100%;
        }

        .shop-item {
            background: #3e2e26;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #5c473d;
        }

        .shop-item h3 { margin: 5px 0; font-size: 16px; }
        .price { color: #ffcc00; font-weight: bold; }

        .buy-btn {
            background: #4caf50;
            border: none;
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            margin-top: 5px;
            width: 100%;
            cursor: pointer;
        }
        
        .buy-btn:disabled { background: #555; }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –≤—ã–ª–µ—Ç–∞—é—â–∏—Ö —Ü–∏—Ñ—Ä */
        .floating-text {
            position: absolute;
            color: #ffcc00;
            font-weight: bold;
            font-size: 20px;
            pointer-events: none;
            animation: floatUp 1s ease-out forwards;
        }

        @keyframes floatUp {
            0% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-50px); }
        }
    </style>
</head>
<body>

    <div class="header">
        <div class="user-info">
            <img id="avatar" class="avatar" src="" alt=""> 
            <span id="username">–ë–æ–±—ë—Ä</span>
        </div>
    </div>

    <div class="balance-container">
        <div>–¢–≤–æ–∏ —â–µ–ø–∫–∏:</div>
        <div class="wood-count" id="score">0</div>
    </div>

    <div class="beaver-btn" id="clicker"></div>

    <div class="shop-title">üè™ –ú–∞–≥–∞–∑–∏–Ω —É–ª—É—á—à–µ–Ω–∏–π</div>
    <div class="shop-grid">
        <div class="shop-item">
            <h3>–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫</h3>
            <div class="price">100 ü™µ</div>
            <button class="buy-btn" onclick="buyItem(100, '–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫')">–ö—É–ø–∏—Ç—å</button>
        </div>
        <div class="shop-item">
            <h3>–ó–æ–ª–æ—Ç–æ–π –ó—É–±</h3>
            <div class="price">500 ü™µ</div>
            <button class="buy-btn" onclick="buyItem(500, '–ó—É–±')">–ö—É–ø–∏—Ç—å</button>
        </div>
    </div>

    <script>
        // --- 2. –õ–û–ì–ò–ö–ê (JAVASCRIPT) ---
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        const tg = window.Telegram.WebApp;
        tg.expand(); // –†–∞—Å–∫—Ä—ã—Ç—å –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω

        // –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const user = tg.initDataUnsafe.user;
        if (user) {
            document.getElementById('username').innerText = user.first_name;
            // (–ê–≤–∞—Ç–∞—Ä–∫–∞ —Ç—Ä–µ–±—É–µ—Ç —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏, –ø–æ–∫–∞ –ø–æ—Å—Ç–∞–≤–∏–º –∑–∞–≥–ª—É—à–∫—É –µ—Å–ª–∏ –Ω–µ—Ç —Ñ–æ—Ç–æ)
            // document.getElementById('avatar').src = user.photo_url; 
        }

        // –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –æ—á–∫–æ–≤ (—á—Ç–æ–±—ã –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–ª–∏—Å—å –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã)
        let score = localStorage.getItem('wood_score') ? parseInt(localStorage.getItem('wood_score')) : 0;
        updateScore();

        // 1. –ö–õ–ò–ö–ï–†
        const clickerBtn = document.getElementById('clicker');
        
        clickerBtn.addEventListener('click', (e) => {
            // –î–æ–±–∞–≤–ª—è–µ–º –æ—á–∫–∏
            score++;
            updateScore();
            
            // –í–∏–±—Ä–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–¢–∞–∫—Ç–∏–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫ - —Ñ–∏—à–∫–∞ Telegram!)
            tg.HapticFeedback.impactOccurred('medium');

            // –ê–Ω–∏–º–∞—Ü–∏—è –≤—ã–ª–µ—Ç–∞—é—â–µ–π —Ü–∏—Ñ—Ä—ã "+1"
            showFloatingText(e.clientX, e.clientY);
        });

        function updateScore() {
            document.getElementById('score').innerText = score;
            localStorage.setItem('wood_score', score);
        }

        // –≠—Ñ—Ñ–µ–∫—Ç –≤—ã–ª–µ—Ç–∞—é—â–∏—Ö —Ü–∏—Ñ—Ä
        function showFloatingText(x, y) {
            const el = document.createElement('div');
            el.className = 'floating-text';
            el.innerText = '+1 ü™µ';
            el.style.left = x + 'px';
            el.style.top = y + 'px';
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 1000);
        }

        // 2. –ü–û–ö–£–ü–ö–ê (–û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç—É)
        function buyItem(price, itemName) {
            if (score >= price) {
                score -= price;
                updateScore();
                
                // –í–∏–±—Ä–∞—Ü–∏—è —É—Å–ø–µ—Ö–∞
                tg.HapticFeedback.notificationOccurred('success');

                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É (–∑–∞–∫—Ä–æ–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø—Ä–∏—à–ª–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç)
                tg.sendData(JSON.stringify({
                    action: "buy",
                    item: itemName,
                    price: price
                }));
            } else {
                // –í–∏–±—Ä–∞—Ü–∏—è –æ—à–∏–±–∫–∏
                tg.HapticFeedback.notificationOccurred('error');
                tg.showAlert("–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç —â–µ–ø–æ–∫! –ì—Ä—ã–∑–∏ –±–æ–ª—å—à–µ!");
            }
        }

    </script>
</body>
</html>
